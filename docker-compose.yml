services:

  sphinx:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: sphinx
    volumes:
      - ./source:/docs/source
    environment:
      - ENVIRONMENT=${ENVIRONMENT}
      - NGINX_PORT=${NGINX_PORT}
    command: sphinx-autobuild -b dirhtml --host 0.0.0.0 /docs/source /docs/_build
    networks:
      - docs_net
    
  nginx:
    image: nginx:1.27.3-alpine3.20
    container_name: nginx
    volumes:
      - ./nginx/conf.d:/etc/nginx/conf.d
    networks:
      - docs_net
    ports:
      - ${NGINX_PORT}:80
    depends_on:
      - sphinx

networks:
  docs_net:
    name: docs_net
    driver: bridge


