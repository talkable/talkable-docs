services:
  talkable-docs:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: talkable-docs
    volumes:
      # Sphinx
      - ./source:/docs/source
      # Nginx
      - ./nginx/http.d:/etc/nginx/http.d
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./nginx/robots/${ENVIRONMENT}.txt:/var/www/robots.txt
      # Build volume to keep the docs available
      - docs_build:/var/www/html
    environment:
      - ENVIRONMENT=${ENVIRONMENT}
      - LOCAL_PORT=${LOCAL_PORT}
      - PRODUCTION_HOST=${PRODUCTION_HOST}
      - STAGING_HOST=${STAGING_HOST}
      - DEVELOPMENT_HOST=${DEVELOPMENT_HOST}
    ports:
      - ${LOCAL_PORT}:8000

volumes:
  docs_build:
